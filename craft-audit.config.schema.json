{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://example.com/craft-audit.config.schema.json",
  "title": "craft-audit configuration",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "$schema": {
      "type": "string"
    },
    "templates": {
      "type": "string",
      "description": "Path to templates directory."
    },
    "skipTemplates": {
      "type": "boolean"
    },
    "changedOnly": {
      "type": "boolean"
    },
    "baseRef": {
      "type": "string",
      "description": "Git base ref or auto."
    },
    "skipSystem": {
      "type": "boolean"
    },
    "skipSecurity": {
      "type": "boolean"
    },
    "securityFileLimit": {
      "type": "number",
      "minimum": 1,
      "description": "Maximum number of files scanned by the security analyzer."
    },
    "skipVisual": {
      "type": "boolean"
    },
    "production": {
      "type": "string"
    },
    "staging": {
      "type": "string"
    },
    "baseline": {
      "oneOf": [
        { "type": "boolean" },
        { "type": "string" }
      ]
    },
    "writeBaseline": {
      "oneOf": [
        { "type": "boolean" },
        { "type": "string" }
      ]
    },
    "output": {
      "type": "string",
      "enum": ["console", "json", "sarif", "bitbucket", "html"]
    },
    "outputFile": {
      "type": "string"
    },
    "exitThreshold": {
      "type": "string",
      "enum": ["none", "high", "medium", "low", "info"]
    },
    "debugProfile": {
      "type": "string",
      "description": "Path to runtime debug profile JSON used to correlate findings."
    },
    "verbose": {
      "type": "boolean"
    },
    "notifySlack": {
      "type": "boolean"
    },
    "slackWebhookUrl": {
      "type": "string"
    },
    "slackSendOn": {
      "type": "string",
      "enum": ["always", "issues", "high"]
    },
    "createClickupTask": {
      "type": "boolean"
    },
    "clickupListId": {
      "type": "string"
    },
    "clickupSendOn": {
      "type": "string",
      "enum": ["always", "issues", "high"]
    },
    "clickupTokenEnv": {
      "type": "string"
    },
    "clickupOnlyNew": {
      "type": "boolean"
    },
    "clickupStateFile": {
      "type": "string"
    },
    "clickupFindingsUrl": {
      "type": "string"
    },
    "createLinearIssue": {
      "type": "boolean",
      "description": "Enable Linear issue creation."
    },
    "linearTeamId": {
      "type": "string",
      "description": "Linear team ID for issue creation."
    },
    "linearSendOn": {
      "type": "string",
      "enum": ["always", "issues", "high"],
      "description": "When to create Linear issues."
    },
    "linearTokenEnv": {
      "type": "string",
      "description": "Env var name for Linear API token.",
      "default": "LINEAR_API_KEY"
    },
    "linearLabelIds": {
      "type": "string",
      "description": "Comma-separated Linear label IDs."
    },
    "linearProjectId": {
      "type": "string",
      "description": "Linear project ID."
    },
    "linearFindingsUrl": {
      "type": "string",
      "description": "URL included in Linear issue body for findings artifact."
    },
    "publishBitbucket": {
      "type": "boolean"
    },
    "bitbucketWorkspace": {
      "type": "string"
    },
    "bitbucketRepoSlug": {
      "type": "string"
    },
    "bitbucketCommit": {
      "type": "string"
    },
    "bitbucketTokenEnv": {
      "type": "string"
    },
    "bitbucketSendOn": {
      "type": "string",
      "enum": ["always", "issues", "high"]
    },
    "bitbucketReportId": {
      "type": "string"
    },
    "bitbucketReportLink": {
      "type": "string"
    },
    "preset": {
      "type": "string",
      "enum": ["strict", "balanced", "legacy-migration"]
    },
    "siteUrl": {
      "type": "string",
      "description": "Site URL for HTTP security header checks (e.g., https://example.com)."
    },
    "cache": {
      "type": "boolean",
      "description": "Enable incremental analysis cache."
    },
    "cacheLocation": {
      "type": "string",
      "description": "Cache file location.",
      "default": ".craft-audit-cache.json"
    },
    "watch": {
      "type": "boolean",
      "description": "Watch for file changes and re-run analysis."
    },
    "rulesDir": {
      "type": "string",
      "description": "Load custom rules from directory."
    },
    "qualityGate": {
      "type": "string",
      "enum": ["strict", "recommended", "security-only", "relaxed", "ci"],
      "description": "Use a named quality gate profile."
    },
    "generateCsp": {
      "type": "boolean",
      "description": "Generate a recommended Content-Security-Policy header."
    },
    "craft5Migration": {
      "type": "boolean",
      "description": "Check for Craft 4â†’5 migration issues."
    },
    "logLevel": {
      "type": "string",
      "enum": ["debug", "info", "warn", "error", "silent"],
      "description": "Set log level.",
      "default": "info"
    },
    "sarifCategory": {
      "type": "string",
      "description": "Category for SARIF output (e.g., 'security', 'templates') for matrix builds."
    },
    "failOnRegression": {
      "type": "boolean",
      "description": "Fail only on new issues compared to baseline (requires baseline)."
    },
    "title": {
      "type": "string",
      "description": "Custom title displayed in audit output headers."
    },
    "ruleSettings": {
      "type": "object",
      "additionalProperties": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "enabled": {
            "type": "boolean"
          },
          "severity": {
            "type": "string",
            "enum": ["high", "medium", "low", "info"]
          },
          "ignorePaths": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      }
    }
  }
}
